<!DOCTYPE html>
<html lang="es" dir="ltr">

<head>
    <title>Login</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="{{url_for('.static', filename='css/home/form-login.css')}}">
    <link rel="stylesheet" href="{{url_for('.static', filename='css/home/progress.css')}}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
</head>

<body>
    <div id="loading"><i class="fa fa-spinner fa-3x fa-spin"></i></div>
    <div class="main">
        <div class="container a-container" id="a-container">
            <form class="form" id="a-form"">
                <h2 class=" form_title title">Create Account</h2>
                <input class="form__input" type="text" placeholder="Lastname" id="lastname" name="lastname">
                <input class="form__input" type="text" placeholder="Firstname" id="firstname" name="firstname">
                <input class="form__input" type="text" placeholder="Username" id="username" name="username">
                <input class="form__input" type="email" placeholder="Email" id="email" name="email">
                <input class="form__input" type="password" placeholder="Password" id="password" name="password">
                <input class="form__input" type="password" placeholder="Confirm Password" id="confirm" name="confirm">
                <input class="form__input" type="text" placeholder="Address" id="address" name="address">
                <input class="form__input" type="text" placeholder="Phone" id="phone" name="phone">
                <input type="submit" class="form__button button" value="SIGN UP" style="cursor: pointer;">
            </form>
        </div>
        <div class="container b-container" id="b-container">
            <form class="form" id="b-form"">
                <h2 class=" form_title title">Sign in to Website</h2>
                <input class="form__input" type="text" placeholder="Username" id="i-username" name="i-username">
                <input class="form__input" type="password" placeholder="Password" id="i-password" name="i-password">
                <a class="form__link" href="/forgot">Forgot your password?</a>
                <input type="submit" class="form__button button" value="SIGN IN" style="cursor: pointer;">
            </form>
        </div>
        <div class="switch" id="switch-cnt">
            <div class="switch__circle"></div>
            <div class="switch__circle switch__circle--t"></div>
            <div class="switch__container" id="switch-c1">
                <h2 class="switch__title title">Welcome Back !</h2>
                <p class="switch__description description">To keep connected with us please login with your personal
                    info</p>
                <button class="switch__button button switch-btn">SIGN IN</button>
            </div>
            <div class="switch__container is-hidden" id="switch-c2">
                <h2 class="switch__title title">Hello Friend !</h2>
                <p class="switch__description description">Enter your personal details and start journey with us</p>
                <button class="switch__button button switch-btn">SIGN UP</button>
            </div>
        </div>
    </div>
    <script src="{{url_for('.static', filename='js/form-login.js')}}"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="{{url_for('.static', filename='jquery/jquery.validate.min.js')}}"></script>
    <script>
        $("#a-form").validate({
            onfocusout: false,
            onkeyup: false,
            onclick: false,
            debug: true,
            success: "valid",
            rules: {
                "lastname": {
                    required: true,
                    rangelength: [1, 15]
                },
                "firstname": {
                    required: true,
                    rangelength: [1, 15]
                },
                "username": {
                    required: true,
                    rangelength: [8, 15]
                },
                "email": {
                    required: true,
                },
                "password": {
                    required: true,
                    rangelength: [8, 15]
                },
                "confirm": {
                    required: true,
                    equalTo: "#password",
                    rangelength: [8, 15]
                },
                "address": {
                    required: true,
                    maxlength: 100
                },
                "phone": {
                    required: true,
                    number: true,
                    rangelength: [10, 10]
                },
            },
            submitHandler: function (form) {
                $.ajax({
                    url: '/signup',
                    dataType: 'json',
                    data: $('form').serialize(),
                    method: 'POST',
                    success: function (aData) {
                        alert(aData.message);
                    },
                    error: function () {
                        alert('Account already exists');
                    },
                    beforeSend: function () {
                        $('#loading').css('display', 'block');
                    },
                    complete: function () {
                        $('#loading').css('display', 'none');
                    }
                });
            }
        });
        $("#b-form").validate({
            onfocusout: false,
            onkeyup: false,
            onclick: false,
            debug: true,
            success: "valid",
            rules: {
                "i-username": {
                    required: true,
                    rangelength: [8, 15]
                },
                "i-password": {
                    required: true,
                    rangelength: [8, 15]
                },
            },
            submitHandler: function (form) {
                $.ajax({
                    url: '/signin',
                    dataType: 'json',
                    data: $('form').serialize(),
                    method: 'POST',
                    success: function (aData) {
                        console.log(aData);
                        if (aData.login) {
                            document.cookie = "token=" + aData.token;
                            window.location.replace('\home');
                        } else {
                            alert(aData.message);
                        }
                    },
                    error: function () {
                        alert('error');
                    },
                    beforeSend: function () {
                        $('#loading').css('display', 'block');
                    },
                    complete: function () {
                        $('#loading').css('display', 'none');
                    }
                });
            }
        });
    </script>
</body>

</html>